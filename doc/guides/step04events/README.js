Ext.data.JsonP.step04events({"guide":"<h2 id='step04events-section-step.4-%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E5%87%A6%E7%90%86'>Step.4 イベントの処理</h2>\n\n<p>List ビューにツールバーを配置し、イベントの処理をします</p>\n\n<h3 id='step04events-section-%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%84%E3%83%AA%E3%82%B9%E3%83%8A%E3%83%BC%E5%AE%9A%E7%BE%A9%E3%81%AE%E8%BF%BD%E5%8A%A0'>ボタンやリスナー定義の追加</h3>\n\n<p><strong>app/view/main/Main.js</strong></p>\n\n<pre><code>    items:[{\n        xtype:      'mylist',\n        reference:  'mylist',\n        tbar: [{\n            text:       '追加',\n            handler:    'onAddList'\n        },{\n            text:       '削除',\n            disabled:   true,\n            reference:  'removeButton',\n            handler:    'onRemoveList'\n        },{\n            text:       '編集',\n            disabled:   true,\n            reference:  'editButton',\n            handler:    'onEditList'\n        }],\n        listeners: {\n            itemdblclick:   'onEditList',\n            selectionchange:'onListSelect'\n        }\n    },{\n</code></pre>\n\n<ul>\n<li><code>handler</code></li>\n<li><code>reference</code></li>\n<li><code>listeners</code></li>\n</ul>\n\n\n<h3 id='step04events-section-main-%E3%83%93%E3%83%A5%E3%83%BC%E3%81%AE-viewcontroller-%E3%82%92%E7%B7%A8%E9%9B%86'>Main ビューの ViewController を編集</h3>\n\n<p><strong>app/view/main/MainController.js</strong></p>\n\n<pre><code>Ext.define('MyList.view.main.MainController', {\n    extend: 'Ext.app.ViewController',\n\n    alias: 'controller.main',\n\n    onAddList: function() {\n        console.log('add list');\n    }\n\n});\n</code></pre>\n\n<ul>\n<li>追加ボタンでコンソールに表示されるのを確認</li>\n</ul>\n\n\n<h3 id='step04events-section-%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E6%B4%BB%E6%80%A7%E5%8C%96%E5%88%B6%E5%BE%A1'>ボタンの活性化制御</h3>\n\n<p><strong>app/view/main/MainController.js</strong></p>\n\n<pre><code>onListSelect: function(view, selected) {\n    var me = this,\n        flag = selected.length === 0,\n        editButton = me.lookupReference('editButton'),\n        removeButton = me.lookupReference('removeButton');\n\n    editButton.setDisabled(flag);\n    removeButton.setDisabled(flag);\n}\n</code></pre>\n\n<ul>\n<li><code>selectionchange</code> イベント</li>\n<li><code>lookupReference</code></li>\n</ul>\n\n\n<h3 id='step04events-section-%E3%81%AE%E3%81%93%E3%82%8A%E3%81%AE%E3%83%AA%E3%82%B9%E3%83%8A%E3%83%BC%E3%82%92%E8%BF%BD%E5%8A%A0'>のこりのリスナーを追加</h3>\n\n<p><strong>app/view/main/MainController.js</strong></p>\n\n<pre><code>onEditList: function() {\n    console.log('edit list');\n},\n\nonRemoveList: function() {\n    console.log('remove list');\n}\n</code></pre>\n\n<h3 id='step04events-section-%E7%B7%A8%E9%9B%86%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%A7-edit-%E3%83%93%E3%83%A5%E3%83%BC%E3%81%AB%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88'>編集ボタンで Edit ビューに切り替え</h3>\n\n<p><code>reference</code> を追加</p>\n\n<p><strong>app/view/main/Main.js</strong></p>\n\n<pre><code>    region:     'center',\n    xtype:      'container',\n    reference:  'center',\n    items:[{\n        xtype:      'mylist',\n        reference:  'mylist',\n</code></pre>\n\n<p>と</p>\n\n<pre><code>    },{\n        xtype:      'myedit',\n        reference:  'myedit'\n</code></pre>\n\n<ul>\n<li><code>center</code></li>\n<li><code>mylist</code></li>\n<li><code>myedit</code></li>\n</ul>\n\n\n<p><strong>app/view/main/MainController.js</strong></p>\n\n<pre><code>setActiveItem: function(panel) {\n    var me = this,\n        center = me.lookupReference('center');\n\n    center.getLayout().setActiveItem(panel);\n},\n\nonEditList: function() {\n    var me = this,\n        list = me.lookupReference('mylist'),\n        edit = me.lookupReference('myedit'),\n        selected = list.getSelection(),\n        vmodel = edit.getViewModel();\n\n    if( selected.length &gt; 0 ) {\n        vmodel.setData({\n            rec: selected[0]\n        });\n        me.setActiveItem(edit);\n    }\n},\n</code></pre>\n\n<ul>\n<li><code>setActiveItem</code></li>\n<li><code>getViewModel</code></li>\n</ul>\n\n\n<h3 id='step04events-section-list-%E3%83%93%E3%83%A5%E3%83%BC%E3%81%AB%E6%88%BB%E3%82%8B'>List ビューに戻る</h3>\n\n<p><strong>app/view/main/Main.js</strong></p>\n\n<p>Edit ビューにツールバー追加</p>\n\n<pre><code>        xtype:      'myedit',\n        reference:  'myedit',\n        fbar: [{\n            text: '登録',\n            handler: 'onSubmit'\n        },{\n            text: 'キャンセル',\n            handler: 'onCancel'\n        }]\n</code></pre>\n\n<p><strong>app/view/main/MainController.js</strong></p>\n\n<pre><code>onSubmit: function() {\n    console.log('submit');\n},\n\nonCancel: function() {\n    console.log('cancel');\n}\n</code></pre>\n\n<p>イベント確認</p>\n\n<h3 id='step04events-section-%E6%88%BB%E3%82%8B%E5%87%A6%E7%90%86%E3%81%A0%E3%81%91'>戻る処理だけ</h3>\n\n<p><strong>app/view/main/MainController.js</strong></p>\n\n<pre><code>onSubmit: function() {\n    var me = this,\n        list = me.lookupReference('mylist');\n\n    me.setActiveItem(list);\n},\n</code></pre>\n\n<ul>\n<li>戻ることを確認</li>\n<li>データが変更されたらグリッドが更新されることを確認</li>\n<li>ダーティマークが消えないのを確認</li>\n</ul>\n\n","title":"Step.4 イベントの処理"});